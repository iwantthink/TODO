# Shell脚本学习

[学习shell](http://billie66.github.io/TLCL/book/index.html)

# 1. 简介

一说到命令行，真正指的其实是 shell。shell 就是一个程序，它接受从键盘输入的命令， 然后把命令传递给操作系统去执行。几乎所有的 Linux 发行版都提供一个名为 bash 的 来自 GNU 项目的 shell 程序。

- “bash” 是 “Bourne Again SHell” 的首字母缩写， 所指的是这样一个事实，bash 是最初 Unix 上由 Steve Bourne 写成 shell 程序 sh 的增强版。


- 当使用图形用户界面时，我们需要另一个和 shell 交互的叫做终端仿真器的程序。 如果我们浏览一下桌面菜单，可能会找到一个。虽然在菜单里它可能都 被简单地称为 “terminal”，但是 KDE 用的是 konsole , 而 GNOME 则使用 gnome-terminal。 还有其他一些终端仿真器可供 Linux 使用，但基本上，它们都完成同样的事情， 让我们能访问 shell。也许，你可能会因为附加的一系列花俏功能而喜欢上某个终端。



# 2. 编写Shell脚本

## 2.1 什么是Shell脚本？

最简单的解释，一个 shell 脚本就是一个包含一系列命令的文件。shell 读取这个文件，然后执行 文件中的所有命令，就好像这些命令已经直接被输入到了命令行中一样。

- Shell 有些独特，因为它不仅是一个功能强大的命令行接口,也是一个脚本语言解释器。我们将会看到， 大多数能够在命令行中完成的任务也能够用脚本来实现，同样地，大多数能用脚本实现的操作也能够 在命令行中完成。


## 2.2 如何编写一个Shell脚本

1. 编写一个脚本

	Shell 脚本就是普通的文本文件

2. 使脚本文件可执行

	系统不允许任何旧的文本文件被看作是一个程序! 所以我们需要设置脚本文件的权限来允许其可执行。

3. 把脚本放置到 shell 能够找到的地方

	当没有指定可执行文件明确的路径名时，shell 会自动地搜索某些目录， 来查找此可执行文件。为了最大程度的方便，我们会把脚本放到这些目录当中。
	
	
### 2.2.1 脚本文件格式

**每一个Shell脚本都需要添加一行固定代码到内容的第一行，以此告诉操作系统将使用什么解释器去执行该脚本**

	#!/bin/bash

- 	`#!`字符序列表示的是`shebang`
	
### 2.2.2 可执行权限

需要给与当前文件可执行的权限

	chmod u=x targetfile
	
### 2.2.3 脚本文件位置

当输入可执行命令之后，Shell会通过查找一个目录列表来获取命令的执行程序. **如果没有给出可执行程序的明确路径名，那么系统每次都会 搜索一系列的目录，来查找此可执行程序**

- 这个目录列表就保存在名为`PATH`的环境变量中，使用冒号进行分隔

	`/bin` 目录就是其中一个系统会自动搜索的目录。

- **按照通常的规则，添加目录到你的 `PATH` 变量或者是定义额外的环境变量，要把这些更改放置到 `.bash_profile` 文件中. 对于其他的更改，需要放到`.bashrc`文件中**

	- export 命令告诉 shell 让这个 shell 的子进程可以使用 PATH 变量的内容

	- source 命令可以让shell重新读取指定文件

	
正常情况下，如果编写了一个脚本，并希望系统中的每个用户都可以使用它， 那么这个脚本的传统位置是 `/usr/local/bin`。系统管理员使用的脚本经常放到 `/usr/local/sbin` 目录下。 大多数情况下，本地支持的软件，不管是脚本还是编译过的程序，都应该放到 `/usr/local `目录下， 而不是在 /bin 或 /usr/bin 目录下
	
	
## 2.3 长/短选项

许多命令都有长短俩种选项名称作为特征，例如,ls命令许多选项可以使用短形式也可以使用长形式

	ls -ad
	
	ls --all --directory
	
- 短选项书写方便，长选项易于读取。 他们实现的功能并没有区别！	
## 2.4 缩进和行继续符

使用长命令的时候，通过把命令在几个文本行中展开，可以提高命令的可读性

- 通过使用行继续符（反斜杠-回车符序列）和缩进，就可以实现这个功能，更加清晰的展示命令。 

- 脚本和 命令行的一个区别是，脚本可能使用 tab 字符来实现缩进，然而命令行却不能，因为 tab 字符被用来 激活自动补全功能。

## 2.5 vim的特殊设置

vim文本编辑器有许多配置可以帮助脚本的编写（**通过把这些命令（没有开头的冒号字符）添加到你的 `~/.vimrc` 文件中，这些改动会永久生效**）

- `:syntax:on`: 打开语法高亮，不同的shell语法元素会以不同的颜色显示 (`:set syntax=sh`备用)

- `:set hlsearch`:打开查找结果高亮

- `:set tabstop=4`:设置一个tab字符所占的列数，默认是8

- `:set autoindent`:打开 “auto indent” 功能。这将导致 vim 能对新的文本行缩进与刚输入的文本行相同的列数。 对于许多编程结构来说，这就加速了输入。停止缩进，输入 Ctrl-d。


# 3. Shell的基础知识

## 3.1 带引号的字符串允许包含换行符

	#!/bin/bash
	# Program to output a system information page
	echo "<HTML>
	    <HEAD>
	          <TITLE>Page Title</TITLE>
	    </HEAD>
	    <BODY>
	          Page body.
	    </BODY>
	</HTML>"

- 一个带引号的字符串可能包含换行符，因此可以包含多个文本行，Shell 会持续读取文本直到它遇到 右引号

	**它在命令行中也是这样工作**
	
	- 需要注意的一点，每当我们在 shell 中键入多行语句的时候， `>`提示符会在每一行开头出现

	
	
## 3.2 变量

当 shell直接碰到一个未创建的变量时，它会自动地创建它

- 当使用的变量并没有提前被初始化，那么其默认被赋值为空

- 通过`$`符号来使用变量


### 3.2.1 变量名的规则

1. 变量名可由字母数字字符（字母和数字）和下划线字符组成。

2. 变量名的第一个字符必须是一个字母或一个下划线。

3. 变量名中不允许出现空格和标点符号

4. Shell 并不能区分常量和变量，大多数情况下只能通过命名习惯来区分，一个常用惯例是指定大写字母来表示常量，小写字母表示真正的变量
	
	- 实际上，shell 确实提供了一种方法，通过使用带有`-r`（只读）选项的内部命令 declare， 来强制常量的不变性

			declare -r TITLE=”Page Title”


	
	
	


	
	